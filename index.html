<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spice Garden - Order Online</title>
    <style>
        /* EASY EDIT SECTION - COLORS AND STYLES */
        :root {
            --primary-color: #2c5f41;
            --secondary-color: #4a9d6f;
            --accent-color: #f39c12;
            --danger-color: #e74c3c;
            --success-color: #27ae60;
            --background-color: #ffffff; /* Changed to white */
            --surface-color: #ffffff;
            --text-color: blue;      /* Changed to blue */
            --text-muted: #7f8c8d;
            --border-color: #ddd;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --border-radius: 12px;
            
            /* EASY EDIT - RUNNING TEXT CUSTOMIZATION */
            --offer-bg-color: #ff4757;
            --offer-text-color: white;
            --offer-text-size: 0.9rem;
            --offer-animation-speed: 25s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            /* padding-bottom: 120px; The cart summary might cover content, adjust if needed */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white; /* Header text color should contrast with its own background */
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-main {
            padding: 1rem 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .restaurant-info {
            flex: 1;
        }

        .restaurant-name {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 0.2rem;
            color: white; /* Ensure header text is white */
        }

        .customer-care {
            font-size: 0.9rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white; /* Ensure header text is white */
        }

        .customer-care a {
            color: white;
            text-decoration: none;
            transition: opacity 0.3s ease;
        }
        .customer-care a:hover { opacity: 0.8; }

        .cart-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;  /* Ensure header cart button text is white */
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        .cart-button:hover { background: rgba(255,255,255,0.3); }

        .offer-banner {
            background: var(--offer-bg-color);
            color: var(--offer-text-color);
            padding: 0.6rem 0;
            overflow: hidden;
            white-space: nowrap;
            position: relative;
        }

        .offer-text {
            display: inline-block;
            animation: scroll-text var(--offer-animation-speed) linear infinite;
            font-size: var(--offer-text-size);
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        @keyframes scroll-text {
            0% { transform: translateX(100vw); }
            100% { transform: translateX(-100%); }
        }

        /* Main Content Area (Menu Page) */
        #menuPageContent { /* Renamed from .main */
            padding: 2rem 0;
            padding-bottom: 120px; /* Ensure space for cart summary */
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
            text-align: center;
        }

        .category-nav { margin-bottom: 2rem; }
        .category-scroll {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem 0;
            scrollbar-width: none;
            -ms-overflow-style: none;
            justify-content: center;
        }
        .category-scroll::-webkit-scrollbar { display: none; }

        .category-card {
            min-width: 90px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }
        .category-card:hover { transform: translateY(-5px); }
        .category-card.active .category-image {
            border: 3px solid var(--accent-color);
            transform: scale(1.05);
        }
        .category-image {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 0.5rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }
        .category-name { font-size: 0.85rem; font-weight: 600; color: var(--text-color); }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .menu-item {
            background: var(--surface-color);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        .item-image-container { width: 100%; height: 160px; position: relative; overflow: hidden; }
        .item-image { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
        .item-image-placeholder {
            width: 100%; height: 100%;
            background: linear-gradient(135deg, #f0f2f5, #e4e8ed);
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; color: var(--text-muted);
        }
        .menu-item:hover .item-image { transform: scale(1.1); }
        .item-content { padding: 1.2rem; display: flex; flex-direction: column; flex: 1; }
        .item-name { font-size: 1.3rem; font-weight: bold; color: var(--primary-color); margin-bottom: 0.8rem; line-height: 1.3; }
        .item-description {
            font-size: 0.9rem; color: var(--text-muted); margin-bottom: 1rem; line-height: 1.5;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
            overflow: hidden; text-overflow: ellipsis; min-height: 2.7rem;
        }
        .item-price { font-size: 1.4rem; font-weight: bold; color: var(--accent-color); margin-bottom: 1.5rem; }
        .item-controls { margin-top: auto; display: flex; justify-content: center; }
        .quantity-controls {
            display: flex; align-items: center; gap: 1rem;
            background: var(--background-color); padding: 0.6rem 1.2rem;
            border-radius: 30px; border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }
        .quantity-controls:hover { border-color: var(--secondary-color); }
        .qty-btn {
            width: 38px; height: 38px; border: none; border-radius: 50%;
            cursor: pointer; font-size: 1.3rem; font-weight: bold;
            transition: all 0.3s ease; display: flex; align-items: center; justify-content: center;
        }
        .qty-btn.minus { background: var(--danger-color); color: white; }
        .qty-btn.plus { background: var(--success-color); color: white; }
        .qty-btn:hover { transform: scale(1.15); box-shadow: var(--shadow); }
        .qty-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .quantity { font-size: 1.2rem; font-weight: bold; min-width: 40px; text-align: center; color: var(--primary-color); }

        /* Cart Summary Bar */
        .cart-summary {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: var(--surface-color); border-top: 1px solid var(--border-color);
            padding: 1rem; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 1000;
        }
        .cart-summary-content {
            display: flex; justify-content: space-between; align-items: center;
            max-width: 1200px; margin: 0 auto; gap: 1rem;
        }
        .cart-info { display: flex; align-items: center; gap: 1rem; }
        .total-amount { font-size: 1.4rem; font-weight: bold; color: var(--primary-color); }
        .view-cart-btn, .share-btn { /* .share-btn is also used on cart page */
            background: var(--secondary-color); color: white; border: none;
            padding: 0.75rem 1.5rem; border-radius: var(--border-radius);
            cursor: pointer; font-weight: 600; transition: all 0.3s ease; font-size: 1rem;
        }
        .share-btn { background: #25D366; } /* Specifically for WhatsApp share */
        .view-cart-btn:hover, .share-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

        /* Cart Page Styles */
        #cartPage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--background-color);
            z-index: 1500; /* Above header and cart summary */
            display: none; /* Hidden by default */
            flex-direction: column;
        }

        .cart-page-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white; /* Header text color should contrast with its own background */
            padding: 1rem;
            display: flex;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1501;
        }

        #backToMenuBtn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-right: 1rem;
            padding: 0.5rem;
        }
        
        #backToMenuBtn:hover {
            opacity: 0.8;
        }

        .cart-page-header h2 {
            font-size: 1.5rem;
            margin: 0;
            color: white; /* Ensure header text is white */
        }

        .cart-page-content-wrapper {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem; /* More padding for a "page" feel */
        }
        
        .cart-page-items-container { /* This will act like the old modal-content box */
            background: var(--surface-color);
            max-width: 700px; /* Or your preferred max width */
            margin: 0 auto; /* Center it */
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);
        }


        .cart-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 0.3rem 0; border-bottom: 1px solid var(--border-color);
        }
        .cart-item:last-child { border-bottom: none; }
        .cart-item-image {
            width: 40px; height: 40px; border-radius: var(--border-radius);
            object-fit: cover; margin-right: 0.75rem; flex-shrink: 0;
        }
        .cart-item-placeholder {
            width: 40px; height: 40px; border-radius: var(--border-radius);
            background: var(--background-color); display: flex; align-items: center; justify-content: center;
            margin-right: 0.75rem; flex-shrink: 0; font-size: 0.9rem;
        }
        .cart-item-details { flex: 1; display: flex; align-items: center; }
        .item-details { flex: 1; }
        .cart-item-name { font-weight: 600; margin-bottom: 0.2rem; font-size: 0.9rem; color: var(--text-color);}
        .item-quantity { color: var(--text-muted); font-size: 0.8rem; margin-bottom: 0.1rem; }
        .item-total { color: var(--accent-color); font-weight: bold; font-size: 0.9rem; }
        .remove-btn {
            background: var(--danger-color); color: white; border: none;
            width: 30px; height: 30px; border-radius: 50%; cursor: pointer;
            font-size: 1rem; margin-left: 1rem; transition: all 0.3s ease;
        }
        .remove-btn:hover { transform: scale(1.1); box-shadow: var(--shadow); }

        .cart-total-section { /* Used in Cart Page */
            border-top: 2px solid var(--primary-color);
            padding-top: 1rem; margin-top: 1rem;
        }
        .total-row {
            display: flex; justify-content: space-between;
            margin-bottom: 0.5rem; font-size: 1.2rem; font-weight: bold;
            color: var(--text-color); /* Apply main text color */
        }
        .clear-cart-btn { /* Used in Cart Page */
            background: var(--danger-color); color: white; border: none;
            padding: 0.5rem 1rem; border-radius: var(--border-radius);
            cursor: pointer; font-size: 0.9rem; margin-right: 1rem;
            transition: all 0.3s ease;
        }
        .clear-cart-btn:hover { background: #c0392b; transform: translateY(-1px); }

        .empty-cart { text-align: center; padding: 3rem 1rem; color: var(--text-muted); }
        .empty-cart-icon { font-size: 4rem; margin-bottom: 1rem; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { padding: 0 10px; }
            .restaurant-name { font-size: 1.4rem; }
            .customer-care { font-size: 0.8rem; }
            .cart-button { padding: 0.4rem 0.8rem; font-size: 0.8rem; }
            .menu-grid { grid-template-columns: 1fr; gap: 1.2rem; }
            .item-image-container { height: 140px; }
            .cart-summary-content { flex-direction: column; gap: 0.5rem; text-align: center; }
            .cart-info { flex-direction: column; gap: 0.5rem; }
            .category-scroll { justify-content: flex-start; padding-left: 1rem; }
            .category-image { width: 60px; height: 60px; font-size: 1.2rem; }
            
            .cart-page-content-wrapper { padding: 1rem; }
            .cart-page-items-container { padding: 1rem; width: 100%; margin: 0; }
            .cart-item-details { flex-direction: column; align-items: flex-start; }
            .cart-item-image, .cart-item-placeholder { width: 45px; height: 45px; margin-right: 0.5rem;}
        }

        @media (max-width: 480px) {
            .restaurant-name { font-size: 1.2rem; }
            .customer-care { font-size: 0.75rem; }
            .section-title { font-size: 1.2rem; }
            .item-image-container { height: 120px; }
            .item-content { padding: 1rem; }
            .quantity-controls { gap: 0.8rem; padding: 0.5rem 1rem; }
            .qty-btn { width: 34px; height: 34px; font-size: 1.1rem; }
            .cart-page-header h2 { font-size: 1.3rem; }
            #backToMenuBtn { font-size: 1rem; }
            .view-cart-btn, .share-btn { padding: 0.6rem 1.2rem; font-size: 0.9rem; }
        }

        @media (min-width: 1200px) {
            .menu-grid { grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" id="mainHeader">
        <div class="header-main">
            <div class="container">
                <div class="header-content">
                    <div class="restaurant-info">
                        <h1 class="restaurant-name" id="restaurantName">Little Bites</h1>
                        <div class="customer-care">
                            üìû Customer Care: <a href="tel:+919876543210" id="customerCareNumber"></a>
                        </div>
                    </div>
                    <button class="cart-button" id="headerCartButton">
                        <span>üõí</span>
                        <span id="cartCount">0</span>
                        <span id="cartTotal">‚Çπ0</span>
                    </button>
                </div>
            </div>
        </div>
        <div class="offer-banner">
            <div class="offer-text" id="offerText"></div>
        </div>
    </header>

    <!-- Main Content Area (Menu Page) -->
    <main id="menuPageContent">
        <div class="container">
            <div class="category-nav">
                <h2 class="section-title">Categories</h2>
                <div class="category-scroll" id="categoryScroll"></div>
            </div>
            <div class="menu-section">
                <h2 class="section-title" id="sectionTitle">Featured Items</h2>
                <div class="menu-grid" id="menuGrid"></div>
            </div>
        </div>
    </main>

    <!-- Cart Page (Replaces Modal) -->
    <div id="cartPage" style="display: none;">
        <div class="cart-page-header">
            <button id="backToMenuBtn">‚Üê Menu</button>
            <h2>Your Order</h2>
        </div>
        <div class="cart-page-content-wrapper">
            <div class="cart-page-items-container">
                <div id="cartPageItemsContainer">
                    <!-- Cart items will be populated here -->
                </div>
                <div class="cart-total-section">
                    <div class="total-row">
                        <span>Total Amount:</span>
                        <span id="cartPageTotal">‚Çπ0</span>
                    </div>
                    <div style="margin-top: 1rem; display: flex; justify-content: space-between;">
                        <button class="clear-cart-btn" id="clearCartPageBtn">Clear Cart</button>
                        <button class="share-btn" id="shareFromCartPageBtn" style="flex-grow: 1; margin-left: 1rem;">
                            Share Order
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Summary Bar (Bottom) -->
    <div class="cart-summary" id="cartSummaryBar" style="display: none;">
        <div class="cart-summary-content">
            <div class="cart-info">
                <span id="mobileCartCount">0 items</span>
                <span class="total-amount" id="mobileCartTotal">‚Çπ0</span>
            </div>
            <div>
                <button class="view-cart-btn" id="summaryViewCartBtn">View Cart</button>
                <button class="share-btn" id="summaryShareBtn">Share</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // EASY EDIT SECTION - RESTAURANT DATA
        // ============================================
        
        const RESTAURANT_DATA = {
            // RESTAURANT INFORMATION - Easy to change
            name: "Spice Garden",
            customerCareNumber: "+919500996515", // Change your customer care number here
            phone: "919500996515", // WhatsApp number without + sign
            currency: "‚Çπ",
            
            // RUNNING TEXT CUSTOMIZATION - Easy to modify
            // Change these values in CSS :root section at the top for:
            // --offer-bg-color: Background color (e.g., #ff4757, #e74c3c, #3742fa)
            // --offer-text-color: Text color (e.g., white, #000, #fff)  
            // --offer-text-size: Text size (e.g., 0.8rem, 0.9rem, 1rem, 1.1rem)
            // --offer-animation-speed: Speed (e.g., 15s=fast, 25s=medium, 40s=slow)
            
            offerText: "Aathira Ramya Vijay",
            
            // CATEGORIES - Easy to edit
            // TO ADD IMAGES: Place images in "images" folder and add path like "images/paneer-tikka.jpg"
            categories: [
                {
                    id: 1,
                    name: "Starters",
                    emoji: "ü•ó",
                    color: "#FF6B6B", // Red
                    items: [
                        { 
                            id: 1, 
                            name: "Paneer Tikka", 
                            price: 180,
                            description: "Grilled cottage cheese cubes marinated in aromatic spices and served with mint chutney",
                            image: "images/paneer-tikka.jpg" // Add your image path here
                        },
                        { 
                            id: 2, 
                            name: "Chicken Wings", 
                            price: 220,
                            description: "Crispy fried chicken wings tossed in special tangy sauce with herbs and spices",
                            image: "images/chicken-wings.jpg"
                        },
                        { 
                            id: 3, 
                            name: "Garlic Naan", 
                            price: 80,
                            description: "Fresh baked bread topped with garlic, herbs and butter, perfect with curries",
                            image: "images/garlic-naan.jpg"
                        },
                        { 
                            id: 4, 
                            name: "Tomato Soup", 
                            price: 90,
                            description: "Rich and creamy tomato soup with fresh herbs, served with bread croutons",
                            image: "images/tomato-soup.jpg"
                        }
                    ]
                },
                {
                    id: 2,
                    name: "Main Course",
                    emoji: "üçõ",
                    color: "#4ECDC4", // Teal
                    items: [
                        { 
                            id: 5, 
                            name: "Butter Chicken", 
                            price: 280,
                            description: "Tender chicken pieces cooked in creamy tomato based gravy with aromatic spices",
                            image: "images/butter-chicken.jpg"
                        },
                        { 
                            id: 6, 
                            name: "Chicken Biryani", 
                            price: 320,
                            description: "Fragrant basmati rice layered with spiced chicken, cooked in traditional dum style",
                            image: "images/chicken-biryani.jpg"
                        },
                        { 
                            id: 7, 
                            name: "Dal Makhani", 
                            price: 180,
                            description: "Rich black lentils slow-cooked with butter, cream and aromatic spices",
                            image: "images/dal-makhani.jpg"
                        },
                        { 
                            id: 8, 
                            name: "Fish Curry", 
                            price: 350,
                            description: "Fresh fish cooked in coconut based spicy curry with curry leaves and spices",
                            image: "images/fish-curry.jpg"
                        }
                    ]
                },
                {
                    id: 3,
                    name: "Beverages",
                    emoji: "ü•§",
                    color: "#45B7D1", // Blue
                    items: [
                        { 
                            id: 9, 
                            name: "Sweet Lassi", 
                            price: 60,
                            description: "Traditional yogurt based refreshing drink sweetened with sugar and cardamom",
                            image: "images/sweet-lassi.jpg"
                        },
                        { 
                            id: 10, 
                            name: "Fresh Lime Water", 
                            price: 40,
                            description: "Fresh lime juice mixed with chilled water, mint leaves and a pinch of salt",
                            image: "images/lime-water.jpg"
                        },
                        { 
                            id: 11, 
                            name: "Masala Chai", 
                            price: 30,
                            description: "Hot spiced tea brewed with milk, cardamom, ginger and other aromatic spices",
                            image: "images/masala-chai.jpg"
                        },
                        { 
                            id: 12, 
                            name: "Cold Coffee", 
                            price: 80,
                            description: "Chilled coffee blended with milk, sugar and topped with vanilla ice cream",
                            image: "images/cold-coffee.jpg"
                        }
                    ]
                },
                {
                    id: 4,
                    name: "Desserts",
                    emoji: "üç∞",
                    color: "#F7B731", // Yellow
                    items: [
                        { 
                            id: 13, 
                            name: "Gulab Jamun", 
                            price: 70,
                            description: "Soft milk balls deep fried and soaked in rose flavored sugar syrup, served warm",
                            image: "images/gulab-jamun.jpg"
                        },
                        { 
                            id: 14, 
                            name: "Kulfi", 
                            price: 90,
                            description: "Traditional Indian ice cream made with milk, sugar and garnished with pistachios",
                            image: "images/kulfi.jpg"
                        },
                        { 
                            id: 15, 
                            name: "Ras Malai", 
                            price: 120,
                            description: "Soft cottage cheese dumplings soaked in sweetened thickened milk with cardamom",
                            image: "images/ras-malai.jpg"
                        },
                        { 
                            id: 16, 
                            name: "Jalebi", 
                            price: 60,
                            description: "Crispy spiral shaped sweets made from flour and soaked in saffron sugar syrup",
                            image: "images/jalebi.jpg"
                        }
                    ]
                }
            ],
            
            // FEATURED ITEMS (show by default) - Use item IDs from above
            featuredItems: [1, 5, 9, 13, 2, 6, 11, 15]
        };

        // ============================================
        // APPLICATION LOGIC
        // ============================================
        
        let cart = {};
        let itemQuantities = {};
        let currentCategory = 'featured';
        let currentPage = 'menuPageContent'; // 'menuPageContent' or 'cartPage'
        
        const allItems = RESTAURANT_DATA.categories.flatMap(cat => 
            cat.items.map(item => ({...item, categoryId: cat.id, categoryName: cat.name}))
        );
        
        // DOM elements
        const mainHeader = document.getElementById('mainHeader');
        const menuPageContent = document.getElementById('menuPageContent');
        const cartPage = document.getElementById('cartPage');
        
        const categoryScroll = document.getElementById('categoryScroll');
        const menuGrid = document.getElementById('menuGrid');
        const sectionTitle = document.getElementById('sectionTitle');
        
        const headerCartButton = document.getElementById('headerCartButton');
        const cartCount = document.getElementById('cartCount'); // In header
        const cartTotal = document.getElementById('cartTotal'); // In header
        
        const cartSummaryBar = document.getElementById('cartSummaryBar');
        const summaryViewCartBtn = document.getElementById('summaryViewCartBtn');
        const summaryShareBtn = document.getElementById('summaryShareBtn');

        const backToMenuBtn = document.getElementById('backToMenuBtn');
        const cartPageItemsContainer = document.getElementById('cartPageItemsContainer');
        const cartPageTotal = document.getElementById('cartPageTotal');
        const clearCartPageBtn = document.getElementById('clearCartPageBtn');
        const shareFromCartPageBtn = document.getElementById('shareFromCartPageBtn');

        function initializeApp() {
            loadCartFromStorage();
            updateRestaurantInfo();
            renderCategories();
            renderFeaturedItems(); // Initial view
            updateCartDisplay(); // Updates header cart and summary bar
            navigateTo('menuPageContent', true); // Show menu page initially
        }

        function updateRestaurantInfo() {
            document.getElementById('restaurantName').textContent = RESTAURANT_DATA.name;
            const careNumberLink = document.getElementById('customerCareNumber');
            careNumberLink.textContent = RESTAURANT_DATA.customerCareNumber;
            careNumberLink.href = `tel:${RESTAURANT_DATA.customerCareNumber}`;
            document.getElementById('offerText').textContent = RESTAURANT_DATA.offerText;
            document.title = `${RESTAURANT_DATA.name} - Order Online`;
        }

        function saveCartToStorage() {
            try {
                localStorage.setItem('spice_garden_cart', JSON.stringify(cart));
                localStorage.setItem('spice_garden_quantities', JSON.stringify(itemQuantities));
            } catch (e) { console.log('Could not save to localStorage'); }
        }

        function loadCartFromStorage() {
            try {
                const savedCart = localStorage.getItem('spice_garden_cart');
                const savedQuantities = localStorage.getItem('spice_garden_quantities');
                if (savedCart) cart = JSON.parse(savedCart);
                if (savedQuantities) itemQuantities = JSON.parse(savedQuantities);
            } catch (e) {
                console.log('Could not load from localStorage');
                cart = {}; itemQuantities = {};
            }
        }
        
        function navigateTo(pageId, isInitialLoad = false) {
            currentPage = pageId;
            if (pageId === 'cartPage') {
                mainHeader.style.display = 'none';
                menuPageContent.style.display = 'none';
                cartPage.style.display = 'flex'; // Use flex for column layout
                cartSummaryBar.style.display = 'none';
                populateCartPageContents();
                window.scrollTo(0, 0); // Scroll to top of cart page
            } else { // 'menuPageContent'
                mainHeader.style.display = 'block'; // Or 'sticky' or original display type
                menuPageContent.style.display = 'block';
                cartPage.style.display = 'none';
                updateCartDisplay(); // This will show/hide summary bar based on cart items
                if (!isInitialLoad) window.scrollTo(0, 0);
            }
        }

        function handleWebViewBackPress() {
            if (currentPage === 'cartPage') {
                navigateTo('menuPageContent');
                return true; // Indicate back press was handled
            }
            return false; // Indicate back press was NOT handled
        }

        function clearCart(refreshCurrentPage = true) {
            cart = {};
            itemQuantities = {};
            saveCartToStorage();
            updateCartDisplay(); // Updates header, summary, and potentially cart page
            
            document.querySelectorAll('[id^="qty-"]').forEach(el => el.textContent = '0');
            
            if (currentPage === 'menuPageContent') {
                 if (currentCategory === 'featured') renderFeaturedItems();
                 else renderCategoryItems(currentCategory);
            } else if (currentPage === 'cartPage' && refreshCurrentPage) {
                populateCartPageContents(); // Refresh the cart page view
            }
        }

        function renderCategories() {
            const featuredCategory = `
                <div class="category-card active" data-category="featured">
                    <div class="category-image" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <span>‚≠ê</span>
                    </div>
                    <div class="category-name">Featured</div>
                </div>`;
            const categoryCards = RESTAURANT_DATA.categories.map(c => `
                <div class="category-card" data-category="${c.id}">
                    <div class="category-image" style="background: ${c.color};"><span>${c.emoji}</span></div>
                    <div class="category-name">${c.name}</div>
                </div>`).join('');
            categoryScroll.innerHTML = featuredCategory + categoryCards;
        }

        function renderFeaturedItems() {
            currentCategory = 'featured';
            const items = allItems.filter(item => RESTAURANT_DATA.featuredItems.includes(item.id));
            renderMenuItems(items, 'Featured Items');
        }

        function renderCategoryItems(categoryId) {
            currentCategory = categoryId;
            const category = RESTAURANT_DATA.categories.find(cat => cat.id === categoryId);
            if (category) {
                renderMenuItems(category.items.map(item => ({...item, categoryId: category.id, categoryName: category.name})), category.name);
            }
        }

        function renderMenuItems(items, title) {
            sectionTitle.textContent = title;
            menuGrid.innerHTML = items.map(item => `
                <div class="menu-item">
                    <div class="item-image-container">
                        ${item.image ? `<img src="${item.image}" alt="${item.name}" class="item-image" onerror="this.parentElement.innerHTML='<div class=&quot;item-image-placeholder&quot;>üçΩÔ∏è</div>'">` : `<div class="item-image-placeholder">üçΩÔ∏è</div>`}
                    </div>
                    <div class="item-content">
                        <h3 class="item-name">${item.name}</h3>
                        ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                        <div class="item-price">${RESTAURANT_DATA.currency}${item.price}</div>
                        <div class="item-controls">
                            <div class="quantity-controls">
                                <button class="qty-btn minus" onclick="changeQuantity(${item.id}, -1)" ${ (itemQuantities[item.id] || 0) === 0 ? 'style="opacity:0.5"' : ''}>-</button>
                                <span class="quantity" id="qty-${item.id}">${itemQuantities[item.id] || 0}</span>
                                <button class="qty-btn plus" onclick="changeQuantity(${item.id}, 1)">+</button>
                            </div>
                        </div>
                    </div>
                </div>`).join('');
        }

        function changeQuantity(itemId, change) {
            const currentQty = itemQuantities[itemId] || 0;
            const newQty = Math.max(0, currentQty + change);
            itemQuantities[itemId] = newQty;

            const qtyEl = document.getElementById(`qty-${itemId}`);
            if (qtyEl) qtyEl.textContent = newQty;
            
            const itemData = allItems.find(i => i.id === itemId);
            if (newQty > 0) cart[itemId] = { ...itemData, quantity: newQty };
            else delete cart[itemId];
            
            saveCartToStorage();
            updateCartDisplay();

            const minusBtn = document.querySelector(`button.qty-btn.minus[onclick="changeQuantity(${itemId}, -1)"]`);
            if(minusBtn) minusBtn.style.opacity = newQty === 0 ? '0.5' : '1';

            // If on cart page, refresh its content
            if (currentPage === 'cartPage') {
                populateCartPageContents();
            }
        }

        function updateCartDisplay() { // Updates header cart icon and bottom summary bar
            const totalItems = Object.values(cart).reduce((sum, item) => sum + item.quantity, 0);
            const totalAmount = Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            cartCount.textContent = totalItems;
            cartTotal.textContent = `${RESTAURANT_DATA.currency}${totalAmount}`;
            
            document.getElementById('mobileCartCount').textContent = `${totalItems} items`;
            document.getElementById('mobileCartTotal').textContent = `${RESTAURANT_DATA.currency}${totalAmount}`;
            
            if (totalItems > 0 && currentPage === 'menuPageContent') { // Only show summary on menu page
                cartSummaryBar.style.display = 'block';
            } else {
                cartSummaryBar.style.display = 'none';
            }
        }

        function populateCartPageContents() {
            const totalAmount = Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0);
            cartPageTotal.textContent = `${RESTAURANT_DATA.currency}${totalAmount}`;

            if (Object.keys(cart).length === 0) {
                cartPageItemsContainer.innerHTML = `
                    <div class="empty-cart">
                        <div class="empty-cart-icon">üõí</div>
                        <h3>Your cart is empty</h3>
                        <p>Add some delicious items from the menu!</p>
                    </div>`;
            } else {
                cartPageItemsContainer.innerHTML = Object.values(cart).map(item => `
                    <div class="cart-item">
                        <div class="cart-item-details">
                            ${item.image ? `<img src="${item.image}" alt="${item.name}" class="cart-item-image" onerror="this.outerHTML='<div class=&quot;cart-item-placeholder&quot;>üçΩÔ∏è</div>'">` : `<div class="cart-item-placeholder">üçΩÔ∏è</div>`}
                            <div class="item-details">
                                <div class="cart-item-name">${item.name}</div>
                                <div class="item-quantity">Quantity: ${item.quantity}</div>
                                <div class="item-total">${RESTAURANT_DATA.currency}${item.price} √ó ${item.quantity} = ${RESTAURANT_DATA.currency}${item.price * item.quantity}</div>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="removeFromCart(${item.id}, true)" title="Remove item">√ó</button>
                    </div>`).join('');
            }
        }

        function removeFromCart(itemId, refreshCartPage = false) {
            delete cart[itemId];
            itemQuantities[itemId] = 0;
            
            const qtyEl = document.getElementById(`qty-${itemId}`);
            if (qtyEl) qtyEl.textContent = '0';

            const minusBtn = document.querySelector(`button.qty-btn.minus[onclick="changeQuantity(${itemId}, -1)"]`);
            if(minusBtn) minusBtn.style.opacity = '0.5';
            
            saveCartToStorage();
            updateCartDisplay(); // Updates header and summary bar

            if (refreshCartPage && currentPage === 'cartPage') {
                populateCartPageContents(); // Refresh cart page content
            }
        }

        function shareViaWhatsApp() {
            if (Object.keys(cart).length === 0) {
                if (typeof Android !== "undefined" && Android.showToast) Android.showToast('Your cart is empty!');
                else alert('Your cart is empty!');
                return;
            }
            let message = `üçΩÔ∏è *New Order from ${RESTAURANT_DATA.name}*\n\nüìã *Order Details:*\n`;
            Object.values(cart).forEach(item => {
                message += `‚Ä¢ ${item.name} √ó ${item.quantity} = ${RESTAURANT_DATA.currency}${item.price * item.quantity}\n`;
            });
            const totalAmount = Object.values(cart).reduce((sum, item) => sum + (item.price * item.quantity), 0);
            message += `\nüí∞ *Total Amount: ${RESTAURANT_DATA.currency}${totalAmount}*\n\n`;
            message += `üìû Customer Care: ${RESTAURANT_DATA.customerCareNumber}\n`;
            message += `Please confirm this order. Thank you! üôè`;
            
            if (typeof Android !== "undefined" && Android.shareText) {
                Android.shareText(message, "Share Order");
            } else {
                window.open(`httpshttps://wa.me/${RESTAURANT_DATA.phone}?text=${encodeURIComponent(message)}`, '_blank');
                if (typeof Android !== "undefined" && Android.showToast) Android.showToast('Using web WhatsApp.');
                else alert('Using web WhatsApp.');
            }
        }

        // Event listeners
        categoryScroll.addEventListener('click', (e) => {
            const card = e.target.closest('.category-card');
            if (card) {
                document.querySelectorAll('.category-card').forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                const categoryId = card.dataset.category;
                if (categoryId === 'featured') renderFeaturedItems();
                else renderCategoryItems(parseInt(categoryId));
            }
        });

        headerCartButton.addEventListener('click', () => navigateTo('cartPage'));
        summaryViewCartBtn.addEventListener('click', () => navigateTo('cartPage'));
        backToMenuBtn.addEventListener('click', () => navigateTo('menuPageContent'));

        summaryShareBtn.addEventListener('click', shareViaWhatsApp);
        shareFromCartPageBtn.addEventListener('click', shareViaWhatsApp);
        
        clearCartPageBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to clear your cart?')) {
                clearCart(true); // true to refresh cart page if on it
                // If on cart page, it will be refreshed. If called from elsewhere, no visual change needed here.
            }
        });
        
        document.addEventListener('dragstart', (e) => { if (e.target.tagName === 'IMG') e.preventDefault(); });
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
